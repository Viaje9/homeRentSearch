import{_ as k,u as $,r as v,w as P,o as f,c as p,a as t,b as g,d as w,p as S,e as j,f as C,F as b,g as U,t as i,h as I,i as L,j as R}from"./index-BwNXPdT3.js";const y=c=>(S("data-v-dbb9e867"),c=c(),j(),c),N={class:"relative"},D=y(()=>t("p",{class:"arrow"},"<",-1)),V=[D],B=y(()=>t("p",{class:"arrow"},">",-1)),T=[B],z={key:0,class:"absolute w-full h-full opacity-50 top-0 left-0 bg-black"},F=y(()=>t("div",{class:"flex items-center justify-center w-full h-full"},[t("div",{class:"px-3 py-1 text-xl font-medium leading-none text-center text-white"}," loading... ")],-1)),M=[F],E={__name:"ProcessImg",props:{postId:{type:Number},imgUrl:{default:"",type:String}},setup(c){const _=$(),{prevImg:d,nextImg:h}=_,x=c,o=v(null),r=v([]),u=v(!1);P(()=>x.imgUrl,(l,e)=>{l!==e&&m(l)},{immediate:!0});function m(l){if(u.value=!0,r.value.some(a=>a.id===l)){const a=r.value.find(n=>n.id===l).canvasRef;o.value.width=a.width,o.value.height=a.height,o.value.getContext("2d").drawImage(a,0,0),u.value=!1;return}const e=new Image;e.src=l,e.onload=()=>{o.value.width=e==null?void 0:e.width,o.value.height=e==null?void 0:e.height,o.value.getContext("2d").drawImage(e,0,0),r.value.push({id:l,canvasRef:e}),u.value=!1},e.onerror=()=>{u.value=!1}}return(l,e)=>(f(),p("div",N,[t("div",{class:"prev",onClick:e[0]||(e[0]=a=>g(d)(c.postId))},V),t("div",{class:"next",onClick:e[1]||(e[1]=a=>g(h)(c.postId))},T),t("canvas",{class:"max-w-full",ref_key:"canvas",ref:o},null,512),u.value?(f(),p("div",z,M)):w("",!0)]))}},q=k(E,[["__scopeId","data-v-dbb9e867"]]),A={class:"flex flex-wrap pb-24 justify-center"},G={class:"p-2"},H={class:"fs-7"},J={key:0,class:"text-red-500 inline"},K=["href"],O={class:"fixed bottom-0 left-0 z-50 w-full h-28 pb-4 bg-slate-500 border-t border-gray-200"},Q={class:"grid h-1/2 max-w-lg grid-cols-4 mx-auto font-medium"},W={class:"flex items-center justify-center col-span-2 text-white"},X={key:0,class:"fixed w-screen h-svh opacity-50 top-0 left-0 bg-black z-50"},Y=t("div",{class:"flex items-center justify-center w-full h-full"},[t("div",{class:"px-3 py-1 text-xl font-medium leading-none text-center text-white"}," loading... ")],-1),Z=[Y],te={__name:"ResultView",setup(c){const _=C(),d=$(),{setData:h,setRentUrlParams:x}=d,o=v(0),r=v(!1);function u(){if(o.value>0){o.value--;const a=l(o.value);r.value=!0,I(`${d.rentUrlParams}${a}`).then(({data:n})=>{h(n.rentList),window.scrollTo(0,0)}).finally(()=>{r.value=!1})}}function m(){const a=Math.floor(+d.records/30);if(o.value<a-1){o.value++;const n=l(o.value);r.value=!0,I(`${d.rentUrlParams}${n}`).then(({data:s})=>{h(s.rentList),window.scrollTo(0,0)}).finally(()=>{r.value=!1})}}const l=a=>{const n=a*30;return a?`&firstRow=${n}`:""};function e(){x(""),_.push({name:"home"})}return(a,n)=>(f(),p(b,null,[t("div",A,[(f(!0),p(b,null,U(g(d).rentData,s=>(f(),p("div",{key:s.post_id,class:"m-2",style:{width:"22rem"}},[L(q,{"post-id":s.post_id,"img-url":s.photo_list[s.currentImgIndex]},null,8,["post-id","img-url"]),t("div",G,[t("p",H,[R(" 圖"+i(s.currentImgIndex+1)+"/"+i(s.photo_list.length)+" ＄"+i(s.price)+" "+i(s.floor_str)+" "+i(s.area)+"坪 ",1),s.count!==1?(f(),p("p",J,"重複次數 "+i(s.count),1)):w("",!0)]),t("a",{class:"fs-7 text-blue-600",href:`https://rent.591.com.tw/rent-detail-${s.post_id}.html`,target:"_blank"},i(s.location),9,K)])]))),128))]),t("div",O,[t("div",{class:"h-1/2 flex items-center justify-center group text-white bg-slate-400",onClick:n[0]||(n[0]=s=>e())}," 重新查詢 "),t("div",Q,[t("button",{type:"button",class:"inline-flex flex-col items-center justify-center px-5 group text-white",onClick:n[1]||(n[1]=s=>u())}," 上一頁 "),t("span",W,"第 "+i(o.value+1)+"/"+i(Math.floor(+g(d).records/30))+" 頁",1),t("button",{type:"button",class:"inline-flex flex-col items-center justify-center px-5 group text-white",onClick:n[2]||(n[2]=s=>m())}," 下一頁 ")])]),r.value?(f(),p("div",X,Z)):w("",!0)],64))}};export{te as default};
