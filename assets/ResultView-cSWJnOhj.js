import{_ as S,u as P,r as v,w as C,o as p,c as h,a as s,b as g,d as y,p as U,e as j,f as L,F as k,g as R,t as l,h as N,i as D}from"./index-DbTP_ldU.js";const b=u=>(U("data-v-f2675929"),u=u(),j(),u),T={class:"relative min-h-276"},V=b(()=>s("p",{class:"arrow"},"<",-1)),B=[V],z=b(()=>s("p",{class:"arrow"},">",-1)),E=[z],F={key:0,class:"absolute w-full h-full opacity-50 top-0 left-0 bg-black"},M=b(()=>s("div",{class:"flex items-center justify-center w-full h-full"},[s("div",{class:"px-3 py-1 text-xl font-medium leading-none text-center text-white"}," loading... ")],-1)),q=[M],A={__name:"ProcessImg",props:{postId:{type:Number},imgUrl:{default:"",type:String}},setup(u){const x=P(),{prevImg:f,nextImg:_}=x,w=u,r=v(null),n=v([]),a=v(!1);C(()=>w.imgUrl,(c,t)=>{c!==t&&m(c)},{immediate:!0});function m(c){if(a.value=!0,n.value.some(i=>i.id===c)){const i=n.value.find(d=>d.id===c).canvasRef;r.value.width=i.width,r.value.height=i.height,r.value.getContext("2d").drawImage(i,0,0),a.value=!1;return}const t=new Image;t.src=c,t.onload=()=>{r.value.width=t==null?void 0:t.width,r.value.height=t==null?void 0:t.height,r.value.getContext("2d").drawImage(t,0,0),n.value.push({id:c,canvasRef:t}),a.value=!1},t.onerror=()=>{a.value=!1}}return(c,t)=>(p(),h("div",T,[s("div",{class:"prev",onClick:t[0]||(t[0]=i=>g(f)(u.postId))},B),s("div",{class:"next",onClick:t[1]||(t[1]=i=>g(_)(u.postId))},E),s("canvas",{class:"max-w-full",ref_key:"canvas",ref:r},null,512),a.value?(p(),h("div",F,q)):y("",!0)]))}},G=S(A,[["__scopeId","data-v-f2675929"]]),H={class:"flex flex-wrap pb-24 justify-center"},J={class:"p-2"},K={class:"fs-7"},O={key:0,class:"text-red-500 inline"},Q=s("br",null,null,-1),W={class:"text-green-600"},X=["href"],Y={class:"fixed bottom-0 left-0 z-50 w-full h-28 pb-4 bg-slate-500 border-t border-gray-200"},Z={class:"grid h-1/2 max-w-lg grid-cols-4 mx-auto font-medium"},ee={class:"flex items-center justify-center col-span-2 text-white"},te={key:0,class:"fixed w-screen h-svh opacity-50 top-0 left-0 bg-black z-50"},se=s("div",{class:"flex items-center justify-center w-full h-full"},[s("div",{class:"px-3 py-1 text-xl font-medium leading-none text-center text-white"}," loading... ")],-1),oe=[se],ae={__name:"ResultView",setup(u){const x=L(),f=P(),{setData:_,setRentUrlParams:w,getRentDataEvent:r}=f,n=v(0),a=v(!1);function m(){if(n.value>0){n.value--;const d=t(n.value);a.value=!0,r(`${f.rentUrlParams}${d}`).then(({data:o})=>{_(o.rentList),window.scrollTo(0,0)}).finally(()=>{a.value=!1})}}function c(){const d=Math.floor(+f.records/30);if(n.value<d-1){n.value++;const o=t(n.value);a.value=!0,r(`${f.rentUrlParams}${o}`).then(({data:e})=>{_(e.rentList),window.scrollTo(0,0)}).finally(()=>{a.value=!1})}}const t=d=>{const o=d*30;return d?`&firstRow=${o}`:""};function i(){w(""),x.push({name:"home"})}return window.scrollTo(0,0),(d,o)=>(p(),h(k,null,[s("div",H,[(p(!0),h(k,null,R(g(f).rentData,e=>{var I,$;return p(),h("div",{key:e.post_id,class:"m-2",style:{width:"22rem"}},[N(G,{"post-id":e.post_id,"img-url":e.photo_list[e.currentImgIndex]},null,8,["post-id","img-url"]),s("div",J,[s("p",K,[D(" 圖"+l(e.currentImgIndex+1)+"/"+l(e.photo_list.length)+" ＄"+l(e.price)+" "+l(e.floor_str)+" "+l(e.area)+"坪 ",1),e.count!==1?(p(),h("p",O,"重複次數 "+l(e.count),1)):y("",!0),Q,s("span",W,l((I=e==null?void 0:e.surrounding)==null?void 0:I.desc)+l(($=e==null?void 0:e.surrounding)==null?void 0:$.distance),1)]),s("a",{class:"fs-7 text-blue-600",href:`https://rent.591.com.tw/rent-detail-${e.post_id}.html`,target:"_blank"},l(e.location),9,X)])])}),128))]),s("div",Y,[s("div",{class:"h-1/2 flex items-center justify-center group text-white bg-slate-400",onClick:o[0]||(o[0]=e=>i())}," 重新查詢 "),s("div",Z,[s("button",{type:"button",class:"inline-flex flex-col items-center justify-center px-5 group text-white",onClick:o[1]||(o[1]=e=>m())}," 上一頁 "),s("span",ee,"第 "+l(n.value+1)+"/"+l(Math.floor(+g(f).records/30))+" 頁",1),s("button",{type:"button",class:"inline-flex flex-col items-center justify-center px-5 group text-white",onClick:o[2]||(o[2]=e=>c())}," 下一頁 ")])]),a.value?(p(),h("div",te,oe)):y("",!0)],64))}};export{ae as default};
