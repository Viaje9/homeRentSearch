import{_ as R,u as C,r as g,w as S,o as v,c as h,a as t,b,d as $,p as U,e as L,f as D,g as N,F as P,h as T,n as V,t as r,i as z,j as B}from"./index-BDZl01Og.js";const I=d=>(U("data-v-f2675929"),d=d(),L(),d),E={class:"relative min-h-276"},F=I(()=>t("p",{class:"arrow"},"<",-1)),M=[F],O=I(()=>t("p",{class:"arrow"},">",-1)),q=[O],A={key:0,class:"absolute w-full h-full opacity-50 top-0 left-0 bg-black"},G=I(()=>t("div",{class:"flex items-center justify-center w-full h-full"},[t("div",{class:"px-3 py-1 text-xl font-medium leading-none text-center text-white"}," loading... ")],-1)),H=[G],J={__name:"ProcessImg",props:{postId:{type:Number},imgUrl:{default:"",type:String}},setup(d){const w=C(),{prevImg:f,nextImg:_}=w,y=d,i=g(null),o=g([]),l=g(!1);S(()=>y.imgUrl,(c,s)=>{c!==s&&p(c)},{immediate:!0});function p(c){if(l.value=!0,o.value.some(u=>u.id===c)){const u=o.value.find(x=>x.id===c).canvasRef;i.value.width=u.width,i.value.height=u.height,i.value.getContext("2d").drawImage(u,0,0),l.value=!1;return}const s=new Image;s.src=c,s.onload=()=>{i.value.width=s==null?void 0:s.width,i.value.height=s==null?void 0:s.height,i.value.getContext("2d").drawImage(s,0,0),o.value.push({id:c,canvasRef:s}),l.value=!1},s.onerror=()=>{l.value=!1}}return(c,s)=>(v(),h("div",E,[t("div",{class:"prev",onClick:s[0]||(s[0]=u=>b(f)(d.postId))},M),t("div",{class:"next",onClick:s[1]||(s[1]=u=>b(_)(d.postId))},q),t("canvas",{class:"max-w-full",ref_key:"canvas",ref:i},null,512),l.value?(v(),h("div",A,H)):$("",!0)]))}},K=R(J,[["__scopeId","data-v-f2675929"]]),Q={class:"flex flex-wrap pb-24 justify-center"},W={class:"p-2"},X={class:"fs-7"},Y={key:0,class:"text-red-500 inline"},Z=t("br",null,null,-1),ee={class:"text-green-600"},te=["href"],se={class:"fixed bottom-0 left-0 z-50 w-full h-28 pb-4 bg-slate-500 border-t border-gray-200"},ne={class:"grid h-1/2 max-w-lg grid-cols-2 mx-auto font-medium"},oe={class:"grid h-1/2 max-w-lg grid-cols-4 mx-auto font-medium"},le={class:"flex items-center justify-center col-span-2 text-white"},ae={key:0,class:"fixed w-screen h-svh opacity-50 top-0 left-0 bg-black z-50"},re=t("div",{class:"flex items-center justify-center w-full h-full"},[t("div",{class:"px-3 py-1 text-xl font-medium leading-none text-center text-white"}," loading... ")],-1),ie=[re],ue={__name:"ResultView",setup(d){const w=D(),f=C(),{setData:_,setRentUrlParams:y,getRentDataEvent:i}=f,o=g(0),l=g(!1),p=g(!1),c=N(()=>f.rentData.reduce((a,n)=>{let e=a.find(m=>m.location===n.location);return e&&!p.value?e.count++:a.push({...n,count:1}),a},[]));function s(){if(o.value>0){o.value--;const a=x(o.value);l.value=!0,i(`${f.rentUrlParams}${a}`).then(({data:n})=>{_(n.rentList),window.scrollTo(0,0)}).finally(()=>{l.value=!1})}}function u(){const a=Math.floor(+f.records/30);if(o.value<a-1){o.value++;const n=x(o.value);l.value=!0,i(`${f.rentUrlParams}${n}`).then(({data:e})=>{_(e.rentList),window.scrollTo(0,0)}).finally(()=>{l.value=!1})}}const x=a=>{const n=a*30;return a?`&firstRow=${n}`:""};function j(){y(""),w.push({name:"home"})}return window.scrollTo(0,0),(a,n)=>(v(),h(P,null,[t("div",Q,[(v(!0),h(P,null,T(c.value,e=>{var m,k;return v(),h("div",{key:e.post_id,class:"m-2",style:{width:"22rem"}},[z(K,{"post-id":e.post_id,"img-url":e.photo_list[e.currentImgIndex]},null,8,["post-id","img-url"]),t("div",W,[t("p",X,[B(" 圖"+r(e.currentImgIndex+1)+"/"+r(e.photo_list.length)+" ＄"+r(e.price)+" "+r(e.floor_str)+" "+r(e.area)+"坪 ",1),e.count!==1?(v(),h("p",Y,"重複次數 "+r(e.count),1)):$("",!0),Z,t("span",ee,r((m=e==null?void 0:e.surrounding)==null?void 0:m.desc)+r((k=e==null?void 0:e.surrounding)==null?void 0:k.distance),1)]),t("a",{class:"fs-7 text-blue-600",href:`https://rent.591.com.tw/rent-detail-${e.post_id}.html`,target:"_blank"},r(e.location),9,te)])])}),128))]),t("div",se,[t("div",ne,[t("button",{type:"button",class:"inline-flex flex-col items-center justify-center bg-slate-400 px-5 text-white",onClick:n[0]||(n[0]=e=>j())}," 重新查詢 "),t("span",{class:V(["inline-flex flex-col items-center justify-center px-5 text-white",{"bg-blue-500":p.value,"bg-gray-500":!p.value}]),onClick:n[1]||(n[1]=e=>p.value=!p.value)}," 顯示重複 ",2)]),t("div",oe,[t("button",{type:"button",class:"inline-flex flex-col items-center justify-center px-5 group text-white",onClick:n[2]||(n[2]=e=>s())}," 上一頁 "),t("span",le,"第 "+r(o.value+1)+"/"+r(Math.floor(+b(f).records/30))+" 頁",1),t("button",{type:"button",class:"inline-flex flex-col items-center justify-center px-5 group text-white",onClick:n[3]||(n[3]=e=>u())}," 下一頁 ")])]),l.value?(v(),h("div",ae,ie)):$("",!0)],64))}};export{ue as default};
