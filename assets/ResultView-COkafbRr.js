import{_ as $,u as I,r as h,w as k,o as u,c as f,a as o,b as g,d as m,p as P,e as S,f as j,F as y,g as C,t as r,h as b,i as L,j as U}from"./index-BLu6FICu.js";const w=c=>(P("data-v-dbb9e867"),c=c(),S(),c),R={class:"relative"},N=w(()=>o("p",{class:"arrow"},"<",-1)),D=[N],V=w(()=>o("p",{class:"arrow"},">",-1)),B=[V],T={key:0,class:"absolute w-full h-full opacity-50 top-0 left-0 bg-black"},z=w(()=>o("div",{class:"flex items-center justify-center w-full h-full"},[o("div",{class:"px-3 py-1 text-xl font-medium leading-none text-center text-white"}," loading... ")],-1)),F=[z],M={__name:"ProcessImg",props:{postId:{type:Number},imgUrl:{default:"",type:String}},setup(c){const x=I(),{prevImg:i,nextImg:v}=x,l=c,a=h(null),p=h([]),d=h(!1);k(()=>l.imgUrl,(n,e)=>{n!==e&&_(n)},{immediate:!0});function _(n){if(d.value=!0,p.value.some(t=>t.id===n)){const t=p.value.find(s=>s.id===n).canvasRef;a.value.width=t.width,a.value.height=t.height,a.value.getContext("2d").drawImage(t,0,0),d.value=!1;return}const e=new Image;e.src=n,e.onload=()=>{a.value.width=e==null?void 0:e.width,a.value.height=e==null?void 0:e.height,a.value.getContext("2d").drawImage(e,0,0),p.value.push({id:n,canvasRef:e}),d.value=!1},e.onerror=()=>{d.value=!1}}return(n,e)=>(u(),f("div",R,[o("div",{class:"prev",onClick:e[0]||(e[0]=t=>g(i)(c.postId))},D),o("div",{class:"next",onClick:e[1]||(e[1]=t=>g(v)(c.postId))},B),o("canvas",{class:"max-w-full",ref_key:"canvas",ref:a},null,512),d.value?(u(),f("div",T,F)):m("",!0)]))}},E=$(M,[["__scopeId","data-v-dbb9e867"]]),q={class:"flex flex-wrap pb-24 justify-center"},A={class:"p-2"},G={class:"fs-7"},H={class:"fs-7"},J={key:0,class:"text-red-500 inline"},K=["href"],O={class:"fixed bottom-0 left-0 z-50 w-full h-24 bg-slate-500 border-t border-gray-200"},Q={class:"grid h-1/2 max-w-lg grid-cols-4 mx-auto font-medium"},W={class:"flex items-center justify-center col-span-2 text-white"},X={key:0,class:"fixed w-screen h-svh opacity-50 top-0 left-0 bg-black z-50"},Y=o("div",{class:"flex items-center justify-center w-full h-full"},[o("div",{class:"px-3 py-1 text-xl font-medium leading-none text-center text-white"}," loading... ")],-1),Z=[Y],te={__name:"ResultView",setup(c){const x=j(),i=I(),{setData:v}=i,l=h(0),a=h(!1);function p(){if(l.value>0){l.value--;const e=_(l.value);a.value=!0,b(`${i.rentUrlParams}${e}`).then(({data:t})=>{v(t.rentList),window.scrollTo(0,0)}).finally(()=>{a.value=!1})}}function d(){const e=Math.floor(+i.records/30);if(l.value<e-1){l.value++;const t=_(l.value);a.value=!0,b(`${i.rentUrlParams}${t}`).then(({data:s})=>{v(s.rentList),window.scrollTo(0,0)}).finally(()=>{a.value=!1})}}const _=e=>{const t=e*30;return e?`&firstRow=${t}`:""};function n(){x.push({name:"home"})}return(e,t)=>(u(),f(y,null,[o("div",q,[(u(!0),f(y,null,C(g(i).rentData,s=>(u(),f("div",{key:s.post_id,class:"m-2",style:{width:"22rem"}},[L(E,{"post-id":s.post_id,"img-url":s.photo_list[s.currentImgIndex]},null,8,["post-id","img-url"]),o("div",A,[o("p",G,r(s.location),1),o("p",H,[U(" 圖 "+r(s.currentImgIndex+1)+"/"+r(s.photo_list.length)+" ＄ "+r(s.price)+" 樓 "+r(s.floor_str)+" ",1),s.count!==1?(u(),f("p",J,"重複次數 "+r(s.count),1)):m("",!0)]),o("a",{class:"fs-7 text-blue-400",href:`https://rent.591.com.tw/rent-detail-${s.post_id}.html`,target:"_blank"},r(s.location),9,K)])]))),128))]),o("div",O,[o("div",{class:"h-1/2 flex items-center justify-center group text-white bg-slate-400",onClick:t[0]||(t[0]=s=>n())}," 重新查詢 "),o("div",Q,[o("button",{type:"button",class:"inline-flex flex-col items-center justify-center px-5 group text-white",onClick:t[1]||(t[1]=s=>p())}," 上一頁 "),o("span",W,"第 "+r(l.value+1)+"/"+r(Math.floor(+g(i).records/30))+" 頁",1),o("button",{type:"button",class:"inline-flex flex-col items-center justify-center px-5 group text-white",onClick:t[2]||(t[2]=s=>d())}," 下一頁 ")])]),a.value?(u(),f("div",X,Z)):m("",!0)],64))}};export{te as default};
