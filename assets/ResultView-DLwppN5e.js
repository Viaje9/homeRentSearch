import{_ as k,u as $,r as h,w as P,o as p,c as v,a as t,b as _,d as y,p as S,e as C,f as U,F as I,g as j,t as d,h as L,i as R}from"./index-2zOsyDC7.js";const b=u=>(S("data-v-dbb9e867"),u=u(),C(),u),N={class:"relative"},D=b(()=>t("p",{class:"arrow"},"<",-1)),V=[D],B=b(()=>t("p",{class:"arrow"},">",-1)),T=[B],z={key:0,class:"absolute w-full h-full opacity-50 top-0 left-0 bg-black"},E=b(()=>t("div",{class:"flex items-center justify-center w-full h-full"},[t("div",{class:"px-3 py-1 text-xl font-medium leading-none text-center text-white"}," loading... ")],-1)),F=[E],M={__name:"ProcessImg",props:{postId:{type:Number},imgUrl:{default:"",type:String}},setup(u){const x=$(),{prevImg:f,nextImg:g}=x,m=u,l=h(null),a=h([]),n=h(!1);P(()=>m.imgUrl,(r,e)=>{r!==e&&w(r)},{immediate:!0});function w(r){if(n.value=!0,a.value.some(i=>i.id===r)){const i=a.value.find(c=>c.id===r).canvasRef;l.value.width=i.width,l.value.height=i.height,l.value.getContext("2d").drawImage(i,0,0),n.value=!1;return}const e=new Image;e.src=r,e.onload=()=>{l.value.width=e==null?void 0:e.width,l.value.height=e==null?void 0:e.height,l.value.getContext("2d").drawImage(e,0,0),a.value.push({id:r,canvasRef:e}),n.value=!1},e.onerror=()=>{n.value=!1}}return(r,e)=>(p(),v("div",N,[t("div",{class:"prev",onClick:e[0]||(e[0]=i=>_(f)(u.postId))},V),t("div",{class:"next",onClick:e[1]||(e[1]=i=>_(g)(u.postId))},T),t("canvas",{class:"max-w-full",ref_key:"canvas",ref:l},null,512),n.value?(p(),v("div",z,F)):y("",!0)]))}},q=k(M,[["__scopeId","data-v-dbb9e867"]]),A={class:"flex flex-wrap pb-24 justify-center"},G={class:"p-2"},H={class:"fs-7"},J={key:0,class:"text-red-500 inline"},K=["href"],O={class:"fixed bottom-0 left-0 z-50 w-full h-28 pb-4 bg-slate-500 border-t border-gray-200"},Q={class:"grid h-1/2 max-w-lg grid-cols-4 mx-auto font-medium"},W={class:"flex items-center justify-center col-span-2 text-white"},X={key:0,class:"fixed w-screen h-svh opacity-50 top-0 left-0 bg-black z-50"},Y=t("div",{class:"flex items-center justify-center w-full h-full"},[t("div",{class:"px-3 py-1 text-xl font-medium leading-none text-center text-white"}," loading... ")],-1),Z=[Y],te={__name:"ResultView",setup(u){const x=U(),f=$(),{setData:g,setRentUrlParams:m,getRentDataEvent:l}=f,a=h(0),n=h(!1);function w(){if(a.value>0){a.value--;const c=e(a.value);n.value=!0,l(`${f.rentUrlParams}${c}`).then(({data:o})=>{g(o.rentList),window.scrollTo(0,0)}).finally(()=>{n.value=!1})}}function r(){const c=Math.floor(+f.records/30);if(a.value<c-1){a.value++;const o=e(a.value);n.value=!0,l(`${f.rentUrlParams}${o}`).then(({data:s})=>{g(s.rentList),window.scrollTo(0,0)}).finally(()=>{n.value=!1})}}const e=c=>{const o=c*30;return c?`&firstRow=${o}`:""};function i(){m(""),x.push({name:"home"})}return(c,o)=>(p(),v(I,null,[t("div",A,[(p(!0),v(I,null,j(_(f).rentData,s=>(p(),v("div",{key:s.post_id,class:"m-2",style:{width:"22rem"}},[L(q,{"post-id":s.post_id,"img-url":s.photo_list[s.currentImgIndex]},null,8,["post-id","img-url"]),t("div",G,[t("p",H,[R(" 圖"+d(s.currentImgIndex+1)+"/"+d(s.photo_list.length)+" ＄"+d(s.price)+" "+d(s.floor_str)+" "+d(s.area)+"坪 ",1),s.count!==1?(p(),v("p",J,"重複次數 "+d(s.count),1)):y("",!0)]),t("a",{class:"fs-7 text-blue-600",href:`https://rent.591.com.tw/rent-detail-${s.post_id}.html`,target:"_blank"},d(s.location),9,K)])]))),128))]),t("div",O,[t("div",{class:"h-1/2 flex items-center justify-center group text-white bg-slate-400",onClick:o[0]||(o[0]=s=>i())}," 重新查詢 "),t("div",Q,[t("button",{type:"button",class:"inline-flex flex-col items-center justify-center px-5 group text-white",onClick:o[1]||(o[1]=s=>w())}," 上一頁 "),t("span",W,"第 "+d(a.value+1)+"/"+d(Math.floor(+_(f).records/30))+" 頁",1),t("button",{type:"button",class:"inline-flex flex-col items-center justify-center px-5 group text-white",onClick:o[2]||(o[2]=s=>r())}," 下一頁 ")])]),n.value?(p(),v("div",X,Z)):y("",!0)],64))}};export{te as default};
